Our Xero integration will automatically sync Chargify billing activity to Xero as Invoices.

**This integration is currently in beta status**.  "What does it mean for a Chargify feature to have beta label?":/beta-label

h2. Availability

The Xero integration is available to merchants:

* On the free Developer plan (for testing), OR
* On the Small Business Plus plan or higher

If you would like to test out the integration during the beta period, but you do not meet these criteria, you may "open a support ticket":https://chargify.zendesk.com/hc/en-us/requests/new and request a one month credit for a free upgrade to the Small Business Plus plan.

h2. How to Enable the Integration

The Xero integration tab is found within the main Integrations tab on each of your Sites:

!/images/doculab/xero-integration-tab.png!

To begin exporting data to Xero, click the "Enable Continuous Xero Exporting" button.  The first time you enable the integration, you will need to follow the prompts to grant us access to your Xero data.

Next, you can configure the integration.

h2. Configuring the Integration

!/images/doculab/xero-configuration.png!

h3. Invoice Account

The "Invoice Account" is the Xero account (from the Chart of Accounts) that will be assigned to all invoice line items (i.e. transactions).  We populate this drop down selection with your accounts from Xero classified as either _sales_, _revenue_, or _other income_.

h3. Payment Account

The "Payment Account" is the Xero account (from the Chart of Accounts) that will be assigned to payments.  We populate this drop down selection with your accounts from Xero classified as either bank accounts or accounts that have payments enabled.

h3. Taxes

h4. US Version of Xero

For the US version of Xero, no tax configuration is necessary.  We "auto-sync" your taxes generated by Chargify by automatically creating matching tax rates within Xero.

_Please do not delete the taxes we create in Xero_!  These taxes have names in the format of @CFYnnn: X% - Tax Name@, where @nnn@ is a 3 digit number and @X@ represents the effective tax rate. If you do delete one of these rates at Xero, we _will recreate it_, so the integration will not be broken.  However, your tax reporting may be affected, in that the same logical tax will be split across several different Xero tax rates (some of them archived).

h4. AU, NZ, and UK Versions of Xero

Xero maintains a set of "System Tax Rates" for certain taxes (like GST) in the AU, NZ, and UK versions. In order to make use of these tax rates, you will need to tell us which Chargify taxes map to which Xero system taxes.

!/images/doculab/xero-tax-mapping.png!

For each of your Chargify-defined tax rates, you may pick a system tax from Xero to which it maps or allow us to sync the tax automatically (as described in the section US versions, above).  If you wish to use the Xero system tax rates, you _must_ select a specific tax rate - do not select "Sync Automatically" in this case.

Note that, if you choose a tax mapping here, we do not make sure that the rates match.  This is up to you.  If you map a 15% tax rate in Chargify to a 10% system tax rate in Xero, then Chargify will calculate and charge the 15% correctly, but the Xero invoice will calculate the rate at 10%.  Then, your Xero invoice will show a "rounding adjustment" for the 5% discrepancy.  In this case, both sides will show the same totals, but you will not have the tax revenue properly accounted on the Xero side.

h2. How it Works

We sync transaction data to Xero under 3 conditions:

1. Any time a new Chargify statement is "closed": this happens at the time of signup, renewal, or upgrade/downgrade migrations.
2. When a Chargify statement is "settled" by receiving a payment.  This usually happens simultaneously to the statement being closed, unless the card fails to charge and we have to retry.
3. When a refund is made.

h3. Syncing Chargify Statements to Xero Invoices

!/images/doculab/xero-invoice.png!

A Xero invoice is created whenever a Chargify statement is closed (i.e. at signup, renewal, or upgrade/downgrade). Here are the steps we take when we create an invoice:

# A Xero "contact" is created or updated to match the Chargify customer details.
# All charges (non-tax line items) are assigned to a single Xero sales/revenue account (that you choose during configuration) and added to a new invoice.
# Discounts from coupons are applied to the invoice line items, as applicable.
# Chargify sends taxation information to Xero, but allows Xero to calculate taxes itself based on rates Chargify supplies:
# Any discrepancies between the Chargify statement and the Xero invoice totals (due to rounding issues in tax calculations, for example), are reconciled via a special line item assigned to the system rounding account
# Unpaid (past due) statements in Chargify are properly reflected as Unpaid Invoices in Xero
# Payments made via Chargify are recorded in Xero, assigned to the account (bank account) of your choosing, and applied to the invoice, marking it as paid
# Credits in Chargify (i.e. negative charges) are synced to Xero as Credit Notes that get attached to the invoice.

Payment data is not pushed to Xero until a Statement is "settled" in Chargify. This happens when the statement is successfully paid, which could be when the renewal happens, or perhaps later after the payment is retried.

h4. Caveats for Negative Statements and Negative Subscription Balances

In Chargify, it is possible to have a statement with a negative total.  This can happen in the case of a downgrade, where the credit for the unused portion of the more expensive plan is more than the cost of the new, less expensive plan.

Chargify statements work off of a "rolling balance" model.  A negative statement just results in an overall negative balance on the subscription, which will be applied towards future charges.  In other words, the next statement will have a negative opening balance, and payment will only be due if the new charges exceed the amount of the negative balance, pushing the balance into positive territory.

You can think of a Chargify statement like a snapshot of the journal entries in an account - each entry affects the account balance by pushing it up or down.

In Xero (and accounting, in general) the concept of a negative invoice doesn't make sense, because the invoice is a record of what an entity owes.  So, there is not always a one-to-one mapping between a Chargify statement and a Xero invoice, since a statement may have a negative total but an invoice may not.

To reconcile this, Chargify statements with negative totals are pushed to Xero as credit notes, not invoices.  Usually, credit notes would be applied to future invoices to offset the amount due, much like Chargify offsets future charges against a negative starting balance.  Where Chargify does this automatically, on a rolling basis, Xero requires an explicit action to link a credit note to an invoice.  Xero calls this "allocating" credit notes to invoices, and we do this for you when an invoice contains both positive and negative charges.  However, due to system limitations, credit notes created due to negative statement totals are NOT automatically allocated to future invoices.  Instead, when a subscription carries a credit into a new statement period (i.e. there is a negative balance), we offset the charges on the Xero invoice with a special line item so that the amount due on the Xero invoice matches the amount due on the Chargify statement.  This means that you may end up with "orphan" credit notes in Xero, which you will want to reconcile later by archiving once the credit has been used up.

h3. Refunds

Refund transactions initiated in Chargify are synced _immediately_ to Xero.  For refunds, we do not wait for the statement to close or settle (even though the refund itself will appear on a Chargify statement).  Refunds are implemented in Xero as a Credit Note with a cash refund applied.

h2. Taxes

Chargify supplies tax rate information to Xero and the taxation status of each line item, and then lets Xero calculate the actual taxes.  Differences in totals due to rounding issues are accounted for by adding adjustments via the system rounding account.

Whether you use Chargify Custom Taxes or Avalara Managed Taxes on the Chargify side, we handle the conversion to Xero taxes for you.

h3. Chargify Custom Taxes

Chargify allows you to create multiple taxes, each of which can have multiple tax rules.  Depending on your configuration, each transaction in Chargify is potentially taxable by multiple taxes and multiple tax rules.

Xero only allows a single tax rate per line item.  To account for this, Chargify taxes for any given transaction are "combined" into a single Xero Tax Rate composed of several Tax Components.  Overall, the Tax Rate we sync to Xero will have the same effective rate as the individual taxes and rules in Chargify.

The lowest available "resolution" for Chargify Custom Taxes is at the state level.  County and local tax jurisdictions cannot be created.  If you require tax resolution at the local level, please use the Avalara Managed Taxes described below.

h3. Avalara Managed Taxes

Avalara Managed Taxes allow you to apply specific sales tax rates, down to the local level, for all of your customers.  For more about this feature, in general, please see the "Avalara Managed Sales Tax documentation":/avalara-managed-sales-tax.

When Avalara Managed Taxes apply to a transaction, we record the individual components of that tax.  For example, most counties in North Carolina have a 6.75% sales tax rate, which is comprised of a 4.75% state tax, and 2.0% county tax.

We sync such a tax to Xero as a single Tax Rate with two components - one for the state tax and one for the county tax.  These taxes are intelligently labeled on the Xero side, so there will never be a question of what tax was applied.

h3. Mapping to Special Xero System Tax Rates

For the AU, NZ, and UK version of Xero, we allow you to map each Chargify tax to a corresponding system tax rate in Xero.  More information on this feature can be found in the section on Tax Configuration, above.

h2. FAQ

h3. Are old statements & transactions synced to Xero?

No, only new statements and transactions that are created _after_ you enable the integration will be sent to Xero.

h3. Can I associate different transactions with different sales or revenue accounts in Xero?

No, at this time, you can only pick on account for all of your invoice line items.

h3. What happens if a Chargify-created Tax Rate is deleted at Xero?

The short answer is: nothing too bad.  We detect that the tax rate has "gone away", and we re-sync it with Xero.  However, this will have the effect of creating a different Tax Rate at Xero, with a different name, but with the same rates.  Since this will segment your tax reports unnecessarily, we recommend that you do not delete the rates we create at Xero.
